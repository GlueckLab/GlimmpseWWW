<!--
* GLIMMPSE (General Linear Multivariate Model Power and Sample size)
* Copyright (C) 2013 Regents of the University of Colorado.
*
* This program is free software; you can redistribute it and/or
* modify it under the terms of the GNU General Public License
* as published by the Free Software Foundation; either version 2
* of the License, or (at your option) any later version.
*
* This program is distributed in the hope that it will be useful,
* but WITHOUT ANY WARRANTY; without even the implied warranty of
* MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
* GNU General Public License for more details.
*
* You should have received a copy of the GNU General Public License
* along with this program; if not, write to the Free Software
* Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.
-->
<h3>Hypotheses</h3>

<p>
    Power and sample size calculations are typically based on the primary study hypothesis.
    The options below show the hypotheses which are available for the current study design.
    Specify the hypothesis which most closely resembles your primary study hypothesis.
</p>

<p>
    To specify a hypothesis, select the type of hypothesis from the dropdown list
    and entered the details.  Note that trends within
    an interaction hypothesis may be specified by selecting the "Interaction" button.
    For more information about the type of hypothesis, click the "More Info" link.
</p>


<div class="input-group">
    <label class="input-description">Hypothesis type</label>
    <select data-ng-model="hypothesis.type" ng-options="type.value as type.label for type in validTypeList">
    </select>
    <button ng-click="showHypothesisTypeInfo()">More info</button>
</div>

<!-- Grand mean hypothesis view -->
<div ng-show="hypothesis.type == glimmpseConstants.hypothesisGrandMean">
    <div class="input-description">
        Enter the known mean to compare against.
    </div>
    <div class="input-group">
        <input type="number" ng-model="thetaNull" autocomplete="off" autofocus required >
    </div>
</div>

<!-- Main effect / Trend hypothesis view -->
<div ng-show="hypothesis.type == glimmpseConstants.hypothesisMainEffect || hypothesis.type == glimmpseConstants.hypothesisTrend">
    <div class="input-description">
        <label ng-show="hypothesis.type == glimmpseConstants.hypothesisMainEffect">
            Select one predictor of interest for the main effect hypothesis.
        </label>
        <label ng-show="hypothesis.type == glimmpseConstants.hypothesisTrend">
            Select one predictor of interest for the trend hypothesis.
        </label>
    </div>

    <div class="input-group">
        <div ng-show="betweenFactorMapList.length > 0">
            <div class="input-description">
                Between Participant Factors
            </div>

            <div class="input-group">
                <div ng-repeat="map in betweenFactorMapList">
                    <input type="radio" name="factorSingleSelect" ng-model="$parent.currentBetweenFactorMap" ng-value="map">
                    {{map.factorMap.betweenParticipantFactor.predictorName}}
                    </input>
                </div>
            </div>
        </div>

        <div ng-show="withinFactorMapList.length > 0">
            <div class="input-description">
                Within Participant Factors
            </div>

            <div class="input-group">
                <div ng-repeat="map in withinFactorMapList">
                    <input type="radio" name="factorSingleSelect" ng-model="$parent.currentWithinFactorMap" ng-value="map">
                    {{map.factorMap.repeatedMeasuresNode.dimension}}
                    </input>
                </div>
            </div>
        </div>
    </div>

    <div ng-show="hypothesis.type == glimmpseConstants.hypothesisTrend">
        <div class="input-description" >
            Select the type of trend for the predictor of interest.
        </div>
        <div class="input-group">
            <div ng-show="currentBetweenFactorMap != undefined">
                <ng-trend-select ng-model="currentBetweenFactorMap.factorMap.type"
                                 name="singleFactorTrendGroup"
                                 levels="getBetweenLevels(currentBetweenFactorMap.factorMap.betweenParticipantFactor)">
                </ng-trend-select>
            </div>
            <div ng-show="currentWithinFactorMap != undefined">
                <ng-trend-select ng-model="currentWithinFactorMap.factorMap.type"
                                 name="singleFactorTrendGroup"
                                 levels="getWithinLevels(currentWithinFactorMap.factorMap.repeatedMeasuresNode)">
                </ng-trend-select>
            </div>
        </div>
    </div>
</div>

<!-- Interaction hypothesis view -->
<div ng-show="hypothesis.type == glimmpseConstants.hypothesisInteraction">
    <div class="input-description">
        Select two or more predictors to include in the interaction
        hypothesis. To test for a trend in a given factor, click the
        "Edit Trend" link and select an appropriate trend.
    </div>

    <div class="input-group">
        <div ng-show="betweenFactorMapList.length > 0">
            <div class="input-description">
                Between Participant Factors
            </div>

            <div class="input-group">
                <table>
                    <tr ng-repeat="map in betweenFactorMapList">
                        <td>
                            <input type="checkbox" ng-model="map.selected" ng-click="updateBetweenFactorMultiSelect(map)">
                            {{map.factorMap.betweenParticipantFactor.predictorName}}
                            </input>
                        </td>
                        <td ng-show="map.selected">
                            <button ng-click="map.showTrends = !map.showTrends">Trend: {{getTrendLabel(map.factorMap.type)}}</button>
                        </td>
                        <td>
                            <div ng-show="map.showTrends" class="input-group">
                                <ng-trend-select ng-model="map.factorMap.type"
                                                 name="map.factorMap.betweenParticipantFactor.predictorName"
                                                 levels="getBetweenLevels(map.factorMap.betweenParticipantFactor)">
                                </ng-trend-select>
                            </div>
                        </td>
                    </tr>
                </table>
            </div>
        </div>

        <div ng-show="withinFactorMapList.length > 0">
            <div class="input-description">
                Within Participant Factors
            </div>

            <div class="input-group">
                <table>
                    <tr ng-repeat="map in withinFactorMapList">
                        <td>
                            <input type="checkbox" ng-model="map.selected" ng-click="updateWithinFactorMultiSelect(map)">
                            {{map.factorMap.repeatedMeasuresNode.dimension}}
                            </input>
                        </td>
                        <td ng-show="map.selected">
                            <button ng-click="map.showTrends = !map.showTrends">Trend: {{getTrendLabel(map.factorMap.type)}}</button>
                        </td>
                        <td>
                            <div ng-show="map.showTrends" class="input-group">
                                <ng-trend-select ng-model="map.factorMap.type"
                                                 name="map.factorMap.repeatedMeasuresNode.predictorName"
                                                 levels="getWithinLevels(map.factorMap.repeatedMeasuresNode)">
                                </ng-trend-select>
                            </div>
                        </td>
                    </tr>
                </table>
            </div>
        </div>
    </div>
</div>



<div ng-show="glimmpseConstants.debug == true">
    <div>
        Between Map list: {{betweenFactorMapList}}
    </div>
    <div>
        Within Map list: {{withinFactorMapList}}
    </div>
    <div>
        Hypothesis: {{studyDesign.hypothesis}}
    </div>
    <div>
        Current Between: {{currentBetweenFactorMap}}
    </div>
    <div>
        Current Within: {{currentWithinFactorMap}}
    </div>

</div>
<!doctype html>
<!--
* GLIMMPSE (General Linear Multivariate Model Power and Sample size)
* Copyright (C) 2013 Regents of the University of Colorado.
*
* This program is free software; you can redistribute it and/or
* modify it under the terms of the GNU General Public License
* as published by the Free Software Foundation; either version 2
* of the License, or (at your option) any later version.
*
* This program is distributed in the hope that it will be useful,
* but WITHOUT ANY WARRANTY; without even the implied warranty of
* MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
* GNU General Public License for more details.
*
* You should have received a copy of the GNU General Public License
* along with this program; if not, write to the Free Software
* Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.
-->
<h3>Independent Sampling Unit Screen</h3>

<p>

    In a clustered design, the independent sampling unit is a cluster, such as a community, school, or classroom. Observations within a cluster are correlated. The labels for observations within a cluster must be exchangeable. For example, child "id" within classroom can be reassigned arbitrarily. In contrast, observations across time cannot be reassigned and should not be considered clustered observations. Clustering, or repeated measures, or a combination, creates a multilevel design. The common correlation between any pair of cluster members is termed the intraclass correlation or intracluster correlation.

</p>

<p>
    To include clustering in the study, click "Add clustering" and follow the prompts. Use the "Remove clustering" button to remove clustering information.
</p>

<div ng-controller="clusteringController">

    <button ng-show="studyDesign.clusteringTree.length==0" data-ng-click="addCluster()">Add Clustering</button>
    <button ng-show="studyDesign.clusteringTree.length==1" data-ng-click="removeCluster(cluster)">Remove Clustering</button>
    <ul type=none>

        <li ng-repeat="cluster in studyDesign.clusteringTree">
            <form name="clusteringForm" class="cluster-contents">

            Cluster label: <input name="clusterName" type="text" placeholder="Enter cluster name" ng-model="cluster.value"
                  autocomplete="off" autofocus required > <br/>
            Number of observations or sub-clusters  <br/>
            within each cluster of this type: <input name="nOfObs" type="number" placeholder="" ng-model="cluster.nOfObs"
                   min='1' step='1' autocomplete="off" autofocus required > <br/>
                <span class="error" ng-show="clusteringForm.nOfObs.$error.min">Please enter a positive number</span>

            Intra-cluster Correlation: <input name="corr" type="number" placeholder="" ng-model="cluster.corr"
                                 min='-1' max='1' step='0.1' autocomplete="off" autofocus required > <br/>
                <span class="error" ng-show="clusteringForm.corr.$error.min">Please enter a number between -1 and 1</span>
                <span class="error" ng-show="clusteringForm.corr.$error.max">Please enter a number between -1 and 1</span>
        </form>
            <button data-ng-click="addSubgroup(cluster)">Add Subgroup</button> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            <!--<button  data-ng-click="removeCluster(cluster)">Remove Subgroup</button>  !-->


         <ul type=none>
            <li ng-repeat="subgroup in cluster.list">
                <form name="clusteringForm" class="cluster-contents">
                Cluster label: <input name="clusterName" type="text" placeholder="Enter cluster name" ng-model="subgroup.value"
                                      autocomplete="off" autofocus required > <br/>
                Number of observations or sub-clusters <br/>
                within each cluster of this type: <input name="nOfObs" type="number" placeholder="" ng-model="subgroup.nOfObs"
                                                         min='1' step='1' autocomplete="off" autofocus required >   <br/>
                <span class="error" ng-show="clusteringForm.nOfObs.$error.min">Please enter a positive number</span>
                Intra-cluster Correlation:  <input name="corr" type="number" placeholder="" ng-model="subgroup.corr"
                                                   min='-1' max='1' step='0.1' autocomplete="off" autofocus required >   <br/>
                    <span class="error" ng-show="clusteringForm.corr.$error.min">Please enter a number between -1 and 1</span>
                    <span class="error" ng-show="clusteringForm.corr.$error.max">Please enter a number between -1 and 1</span>
                </form>
                <button data-ng-click="addSubSubgroup(subgroup)">Add Subgroup</button>
                <button data-ng-click="removeSubgroup(cluster, subgroup)">Remove Subgroup</button>

                <ul type=none>
                    <li ng-repeat="subsubgroup in subgroup.list">

                        <form name="clusteringForm" class="cluster-contents">
                            Cluster label: <input name="clusterName" type="text" placeholder="Enter cluster name" ng-model="subsubgroup.value"
                                                  autocomplete="off" autofocus required > <br/>
                            Number of observations or sub-clusters <br/>
                            within each cluster of this type: <input name="nOfObs" type="number" placeholder="" ng-model="subsubgroup.nOfObs"
                                                                     min='1' step='1' autocomplete="off" autofocus required >   <br/>
                            <span class="error" ng-show="clusteringForm.nOfObs.$error.min">Please enter a positive number</span>
                            Intra-cluster Correlation:  <input name="corr" type="number" placeholder="" ng-model="subsubgroup.corr"
                                                               min='-1' max='1' step='0.1' autocomplete="off" autofocus required >   <br/>
                            <span class="error" ng-show="clusteringForm.corr.$error.min">Please enter a number between -1 and 1</span>
                            <span class="error" ng-show="clusteringForm.corr.$error.max">Please enter a number between -1 and 1</span>
                        </form>

                        <button data-ng-click="removeSubgroup(subgroup, subsubgroup)">Remove Subgroup</button>
                    </li>

                </ul>

            </li>

            </ul>



        </li>
    </ul>

</div>







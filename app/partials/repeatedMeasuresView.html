<!doctype html>
<!--
* GLIMMPSE (General Linear Multivariate Model Power and Sample size)
* Copyright (C) 2013 Regents of the University of Colorado.
*
* This program is free software; you can redistribute it and/or
* modify it under the terms of the GNU General Public License
* as published by the Free Software Foundation; either version 2
* of the License, or (at your option) any later version.
*
* This program is distributed in the hope that it will be useful,
* but WITHOUT ANY WARRANTY; without even the implied warranty of
* MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
* GNU General Public License for more details.
*
* You should have received a copy of the GNU General Public License
* along with this program; if not, write to the Free Software
* Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.
-->
<h3>
    Repeated Measures
</h3>

<p>
    Repeated measures are present when a response variable is measured on each research
    participant on two or more occasions or under two or more conditions.
</p>

<p>
    If the study includes repeated measurements, click “Add repeated measures” and follow
    the prompts. The text entered in the "Units" text box indicates the dimension over
    which measures were taken (ex. time, days, locations, etc.). The choice of "Type"
    indicates whether the repeated measures are numeric (ex. time), ordinal (ex. 1st,
    2nd, 3rd), or categorical (ex. arm, leg, hand).
</p>

<p>
    You may specify up to 3 factors of repeated measures.
</p>

<div>
    <button class="btn btn-primary vmargin15" ng-show="studyDesign.repeatedMeasuresTree.length <= 0"
            data-ng-click="addLevel()">Add Repeated Measures</button>

    <div class="well" ng-repeat="factor in studyDesign.repeatedMeasuresTree">
        <form novalidate name="rmForm">
            <div class="form-group">
                <label>Units (Level {{$index+1}})</label>
                <input name="dimension" class="form-control" type="text"
                       placeholder="Enter the units for this factor of repeated measures (time, scenarios, etc.)"
                       ng-model="factor.dimension" ng-change="updateDimension(factor, $index)"
                       autocomplete="off" autofocus required >
            </div>
            <div class="form-group">
                <label>Type</label>
                <select  class="form-control" ng-model="factor.repeatedMeasuresDimensionType"
                         ng-options="opt.value as opt.label for opt in validTypes" required>
                </select>
            </div>
            <div class="form-group">
                <label>Number of measurements</label>
                <select class="form-control" ng-model="factor.numberOfMeasurements"
                        ng-change="updateNumberOfMeasurements(factor, $index)"
                        ng-options="option as option for option in validNumberOfMeasurements" required>
                </select>
            </div>
            <div class="form-group" ng-show="factor.repeatedMeasuresDimensionType == glimmpseConstants.repeatedMeasuresTypeNumeric">
                <label>Spacing</label>
                <input ng-repeat="spacing in factor.spacingList"
                       class="vmargin5 form-control" type="number" ng-model="spacing.value"
                       min='1' autofocus required >
                </input>
                <div class="vmargin5">
                    <button class="btn btn-xs btn-primary" ng-click="resetToEqualSpacing(factor)">
                        Reset to Equal Spacing
                    </button>
                </div>
            </div>
        </form>
    </div>

    <div>
        <button class="btn btn-primary"
                ng-show="studyDesign.repeatedMeasuresTree.length > 0 && studyDesign.repeatedMeasuresTree.length < 3"
                data-ng-click="addLevel()">Add Level</button>
        <button class="btn btn-warning" ng-show="studyDesign.repeatedMeasuresTree.length > 0"
                data-ng-click="removeLevel()">Remove Level</button>
        <button class="btn btn-danger" ng-show="studyDesign.repeatedMeasuresTree.length > 0"
                data-ng-click="removeRepeatedMeasures()">Clear All</button>
    </div>

    <div ng-show="glimmpseConstants.debug == true">
        <div>
            RM Tree: {{studyDesign.repeatedMeasuresTree}}
        </div>
        <div>
            Response combinations ({{metaData.getNumberOfResponseCombinations()}}): {{metaData.responseCombinationList}}
        </div>
        <div>
            Covariance: {{studyDesign.covariance}}
        </div>
    </div>
</div>
